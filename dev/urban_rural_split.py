import pandas as pd

df = pd.read_excel('2020_UA_COUNTY.xlsx')

state_abbr = {
    'Alabama': 'AL', 'Alaska': 'AK', 'Arizona': 'AZ', 'Arkansas': 'AR', 'California': 'CA',
    'Colorado': 'CO', 'Connecticut': 'CT', 'Delaware': 'DE', 'Florida': 'FL', 'Georgia': 'GA',
    'Hawaii': 'HI', 'Idaho': 'ID', 'Illinois': 'IL', 'Indiana': 'IN', 'Iowa': 'IA', 'Kansas': 'KS',
    'Kentucky': 'KY', 'Louisiana': 'LA', 'Maine': 'ME', 'Maryland': 'MD', 'Massachusetts': 'MA',
    'Michigan': 'MI', 'Minnesota': 'MN', 'Mississippi': 'MS', 'Missouri': 'MO', 'Montana': 'MT',
    'Nebraska': 'NE', 'Nevada': 'NV', 'New Hampshire': 'NH', 'New Jersey': 'NJ', 'New Mexico': 'NM',
    'New York': 'NY', 'North Carolina': 'NC', 'North Dakota': 'ND', 'Ohio': 'OH', 'Oklahoma': 'OK',
    'Oregon': 'OR', 'Pennsylvania': 'PA', 'Rhode Island': 'RI', 'South Carolina': 'SC', 'South Dakota': 'SD',
    'Tennessee': 'TN', 'Texas': 'TX', 'Utah': 'UT', 'Vermont': 'VT', 'Virginia': 'VA', 'Washington': 'WA',
    'West Virginia': 'WV', 'Wisconsin': 'WI', 'Wyoming': 'WY', "District of Columbia": 'DC', "American Samoa": 'XX',
    "Guam": 'XX', "Commonwealth of the Northern Marianas": 'XX', "Puerto Rico": 'PR', "US Virgin Islands": 'XX'
}

counties_dict = {}

for index, row in df.iterrows():
    state = row['STATE_NAME']
    county = row['COUNTY_NAME']
    urban_percentage = row['POPPCT_URB']

    state_code = state_abbr[state]
    county_key = f"{county} County, {state_code}"

    print(urban_percentage)
    if urban_percentage > 0.5:
        label = "URBAN"
    elif urban_percentage < 0.5:
        label = "RURAL"
    else:
        label = "SPLIT"

    counties_dict[county_key] = label

original_counties = ['Calhoun County, AL', 'Tulsa County, OK', 'Saginaw County, MI', 'Hillsborough County, FL', 'Lake County, IN', 'St. Tammany Parish, LA', 'Osceola County, FL', 'Sarpy County, NE', 'Kane County, IL', 'San Juan County, NM', 'Denton County, TX', 'Hays County, TX', 'Davis County, UT', 'Manatee County, FL', 'New Haven County, CT', 'San Mateo County, CA', 'San Luis Obispo County, CA', 'Canyon County, ID', 'Cherokee County, GA', 'Stanislaus County, CA', 'Monterey County, CA', 'Orange County, NY', 'Marin County, CA', 'Lexington County, SC', 'Henry County, GA', 'Orleans Parish, LA', 'Miami-Dade County, FL', 'Pulaski County, AR', 'Brazos County, TX', 'Salt Lake County, UT', 'Clark County, NV', 'Sullivan County, TN', 'Jefferson County, KY', 'Bronx County, NY', 'Lake County, FL', 'Henrico County, VA', 'Yolo County, CA', 'Northampton County, PA', 'Scott County, MN', 'Lane County, OR', 'Tazewell County, IL', 'Clark County, WA', 'Randolph County, NC', 'Ocean County, NJ', 'St. Louis city, MO', 'Marion County, IN', 'El Paso County, TX', 'Gwinnett County, GA', 'Wilson County, TN', 'Craven County, NC', 'Rock County, WI', 'Luzerne County, PA', 'Atlantic County, NJ', 'Denver County, CO', 'Warren County, OH', 'Porter County, IN', 'Durham County, NC', 'Olmsted County, MN', 'Cowlitz County, WA', 'St. Lawrence County, NY', 'Allen County, OH', 'Bibb County, GA', 'Peoria County, IL', 'Fulton County, GA', 'Washington County, AR', 'Coweta County, GA', 'Jefferson County, CO', 'Greene County, MO', 'Johnson County, IA', 'Eaton County, MI', 'Sheboygan County, WI', 'Worcester County, MA', 'Clackamas County, OR', 'Santa Cruz County, CA', 'Boone County, MO', 'Madison County, IL', 'Madison County, IN', 'Livingston Parish, LA', 'Guadalupe County, TX', 'Harris County, TX', 'Allen County, IN', 'Dallas County, TX', 'Benton County, AR', 'Minnehaha County, SD', 'Hudson County, NJ', 'Okaloosa County, FL', 'Arapahoe County, CO', 'Johnson County, TX', 'Brunswick County, NC', 'Howard County, MD', 'Ada County, ID', 'Cumberland County, NC', 'Dutchess County, NY', 'York County, ME', 'Wright County, MN', 'Placer County, CA', 'Muscogee County, GA', 'Lee County, AL', 'Muskegon County, MI', 'Milwaukee County, WI', 'Broward County, FL', 'Delaware County, IN', 'Wayne County, MI', 'Macon County, IL', 'Cuyahoga County, OH', 'Merced County, CA', 'Schuylkill County, PA', 'Monroe County, PA', 'DuPage County, IL', 'Schenectady County, NY', 'Pinal County, AZ', 'Montgomery County, MD', 'Washington County, WI', 'Honolulu County, HI', 'Johnson County, KS', 'Santa Fe County, NM', 'Hartford County, CT', 'Iredell County, NC', 'El Dorado County, CA', 'Cumberland County, PA', 'King County, WA', 'Kitsap County, WA', 'Oswego County, NY', 'Lubbock County, TX', 'Escambia County, FL', 'Charleston County, SC', 'Hardin County, KY', 'Ellis County, TX', 'Frederick County, MD', 'Allegan County, MI', 'Warren County, NJ', 'Ventura County, CA', 'Berrien County, MI', 'Kent County, MI', 'Beaver County, PA', 'Mercer County, PA', 'Kenosha County, WI', 'Adams County, CO', 'Franklin County, MO', 'Chesterfield County, VA', 'Kings County, NY', 'Suffolk County, MA', 'Ulster County, NY', 'Kanawha County, WV', 'Lafayette Parish, LA', 'St. Louis County, MO', 'Bexar County, TX', 'Fond du Lac County, WI', 'St. Lucie County, FL', 'Clay County, MO', 'Berkeley County, SC', 'Lee County, FL', 'Greenville County, SC', 'Monroe County, MI', 'Bell County, TX', 'San Francisco County, CA', 'Berkshire County, MA', 'Yuma County, AZ', 'Hampden County, MA', 'Missoula County, MT', 'Ramsey County, MN', 'Pierce County, WA', 'Hennepin County, MN', 'Solano County, CA', 'Plymouth County, MA', 'Jackson County, OR', 'Centre County, PA', 'Sangamon County, IL', 'Cameron County, TX', 'Horry County, SC', 'Baldwin County, AL', 'Douglas County, NE', 'Camden County, NJ', 'Middlesex County, NJ', 'Wood County, OH', 'Pasco County, FL', 'Lycoming County, PA', 'Harford County, MD', 'Livingston County, MI', 'Oneida County, NY', 'Lancaster County, PA', 'Multnomah County, OR', 'Richland County, SC', 'Jefferson County, TX', 'Montgomery County, TN', 'Jackson County, MO', 'Clarke County, GA', 'Clark County, OH', 'Hamilton County, OH', 'Waukesha County, WI', 'Lebanon County, PA', 'Davidson County, NC', 'Washoe County, NV', 'Union County, NC', 'Harnett County, NC', 'Indian River County, FL', 'Fayette County, PA', 'Bay County, MI', 'Caddo Parish, LA', 'East Baton Rouge Parish, LA', 'Taylor County, TX', 'Fairfield County, OH', 'Leon County, FL', 'Macomb County, MI', 'Ashtabula County, OH', 'Larimer County, CO', 'El Paso County, CO', 'Westmoreland County, PA', 'Hunterdon County, NJ', 'Richmond County, NY', 'Norfolk County, MA', 'Henderson County, NC', 'Ontario County, NY', 'Butte County, CA', 'Kootenai County, ID', 'Calhoun County, MI', 'Linn County, OR', 'Spokane County, WA', 'Wyandotte County, KS', 'Shawnee County, KS', 'Tuscaloosa County, AL', 'Fayette County, KY', 'Baltimore city, MD', 'Tarrant County, TX', 'Essex County, NJ', 'DeKalb County, GA', 'Santa Rosa County, FL', 'York County, PA', 'Lake County, IL', 'Summit County, OH', 'Brevard County, FL', 'Cabarrus County, NC', 'Suffolk County, NY', 'Greene County, OH', 'Los Angeles County, CA', 'Clark County, IN', 'Hampton city, VA', 'Berks County, PA', 'Utah County, UT', 'Marion County, FL', 'Smith County, TX', 'Weld County, CO', 'Delaware County, PA', "St. Mary's County, MD", 'Essex County, MA', 'Hillsborough County, NH', 'Deschutes County, OR', 'Middlesex County, MA', 'Napa County, CA', 'Pueblo County, CO', "Prince George's County, MD", 'Anderson County, SC', 'Davidson County, TN', 'Erie County, PA', 'Genesee County, MI', 'Robeson County, NC', 'Duval County, FL', 'San Bernardino County, CA', 'St. Clair County, MI', 'Chesapeake city, VA', 'Boone County, KY', 'Washington County, PA', 'New York County, NY', 'Richland County, OH', 'Dona Ana County, NM', 'Albany County, NY', 'Black Hawk County, IA', 'Anne Arundel County, MD', 'Strafford County, NH', 'Saratoga County, NY', 'Tompkins County, NY', 'Humboldt County, CA', 'Montgomery County, AL', 'Calcasieu Parish, LA', 'Shelby County, TN', 'Midland County, TX', 'Faulkner County, AR', 'Forsyth County, GA', 'Williamson County, TN', 'Kankakee County, IL', 'Norfolk city, VA', 'Hamilton County, TN', 'Collin County, TX', 'St. Charles County, MO', 'Saline County, AR', 'Richmond County, GA', 'Tippecanoe County, IN', 'Pickens County, SC', 'Fairfax County, VA', 'Gloucester County, NJ', 'Portage County, OH', 'Gaston County, NC', 'Hinds County, MS', 'DeSoto County, MS', 'Etowah County, AL', 'Vanderburgh County, IN', 'Houston County, AL', 'Tom Green County, TX', 'Jackson County, MS', 'St. Clair County, IL', 'Cleveland County, OK', 'Blount County, TN', 'Coconino County, AZ', 'Alamance County, NC', 'LaSalle County, IL', 'Stark County, OH', 'Sumner County, TN', 'McLean County, IL', 'Santa Barbara County, CA', 'Kern County, CA', 'Winnebago County, WI', 'Cochise County, AZ', 'Stafford County, VA', 'Butler County, PA', 'Kent County, RI', 'Litchfield County, CT', 'Dakota County, MN', 'Onslow County, NC', 'Jefferson County, AL', 'Ascension Parish, LA', 'Palm Beach County, FL', 'Pima County, AZ', 'Randall County, TX', 'Will County, IL', 'Clay County, FL', 'Woodbury County, IA', 'Comal County, TX', 'Queens County, NY', 'Brown County, WI', 'Ottawa County, MI', 'Chautauqua County, NY', 'Benton County, WA', 'Windham County, CT', 'Kenton County, KY', 'Orange County, CA', 'Burlington County, NJ', 'Yavapai County, AZ', 'Martin County, FL', 'Lake County, OH', 'Mecklenburg County, NC', 'Tulare County, CA', 'Buncombe County, NC', 'Sonoma County, CA', 'Columbia County, GA', 'Jefferson County, NY', 'Medina County, OH', 'Rockland County, NY', 'Niagara County, NY', 'Rowan County, NC', 'Fresno County, CA', 'McLennan County, TX', 'Jasper County, MO', 'Johnson County, IN', 'Charles County, MD', 'Sebastian County, AR', 'Maricopa County, AZ', 'Canadian County, OK', 'Ingham County, MI', 'Franklin County, OH', 'Prince William County, VA', 'Marathon County, WI', 'Contra Costa County, CA', 'Bartow County, GA', 'Anoka County, MN', 'Lehigh County, PA', 'Wayne County, NC', 'Mohave County, AZ', 'Sarasota County, FL', 'Washtenaw County, MI', 'Cumberland County, ME', 'Elkhart County, IN', 'Chittenden County, VT', 'Merrimack County, NH', 'Madison County, AL', 'Bonneville County, ID', 'Oklahoma County, OK', 'Brazoria County, TX', 'Sedgwick County, KS', 'Linn County, IA', 'Polk County, FL', 'Pennington County, SD', 'Sussex County, DE', 'Union County, NJ', 'Williamson County, TX', 'Riverside County, CA', 'Paulding County, GA', 'New London County, CT', 'Boulder County, CO', 'Montgomery County, PA', 'Hampshire County, MA', 'Androscoggin County, ME', 'Onondaga County, NY', 'Spartanburg County, SC', 'Montgomery County, OH', 'Harrison County, MS', 'Winnebago County, IL', 'Champaign County, IL', 'Orange County, FL', 'Lackawanna County, PA', 'Yakima County, WA', 'San Diego County, CA', 'Somerset County, NJ', 'Delaware County, OH', 'Franklin County, PA', 'Miami County, OH', 'Pinellas County, FL', 'Arlington County, VA', 'Adams County, PA', 'Marion County, OR', 'La Crosse County, WI', 'Carroll County, MD', 'Mobile County, AL', 'Ector County, TX', 'Douglas County, GA', 'Mahoning County, OH', 'Aiken County, SC', 'Racine County, WI', 'Guilford County, NC', 'Baltimore County, MD', 'Butler County, OH', 'District of Columbia, DC', 'Mesa County, CO', 'Wake County, NC', 'Bucks County, PA', 'Hawaii County, HI', 'Jefferson County, MO', 'Jefferson Parish, LA', 'Lowndes County, GA', 'Madera County, CA', 'Scott County, IA', 'Cambria County, PA', 'Bergen County, NJ', 'Lancaster County, NE', 'Outagamie County, WI', 'Montgomery County, TX', 'New Castle County, DE', 'Middlesex County, CT', 'Wayne County, OH', 'Rensselaer County, NY', 'Rockingham County, NH', 'Rutherford County, TN', 'Morgan County, AL', 'Passaic County, NJ', 'Chatham County, GA', 'Knox County, TN', 'Sandoval County, NM', 'St. Joseph County, IN', 'Lucas County, OH', 'Bernalillo County, NM', 'Philadelphia County, PA', 'Dauphin County, PA', 'McHenry County, IL', 'Loudoun County, VA', 'San Joaquin County, CA', 'Anchorage Borough, AK', 'Allegheny County, PA', 'Kent County, DE', 'York County, SC', 'Stearns County, MN', 'Volusia County, FL', 'Polk County, IA', 'Monmouth County, NJ', 'Virginia Beach city, VA', 'St. Johns County, FL', 'Sussex County, NJ', 'Alexandria city, VA', 'Potter County, TX', 'Trumbull County, OH', 'Houston County, GA', 'Licking County, OH', 'Cook County, IL', 'Collier County, FL', 'Cumberland County, NJ', 'Douglas County, CO', 'Cache County, UT', 'Sacramento County, CA', 'Fairfield County, CT', 'Berkeley County, WV', 'Monroe County, NY', 'Alameda County, CA', 'Washington County, MN', 'Tolland County, CT', 'Bristol County, MA', 'Johnston County, NC', 'Providence County, RI', 'Dane County, WI', 'Kalamazoo County, MI', 'St. Louis County, MN', 'Walworth County, WI', 'Hidalgo County, TX', 'Fort Bend County, TX', 'Galveston County, TX', 'Richmond city, VA', 'Hamilton County, IN', 'Hendricks County, IN', 'Cobb County, GA', 'Dorchester County, SC', 'Weber County, UT', 'Newport News city, VA', 'Lorain County, OH', 'Erie County, NY', 'Travis County, TX', 'Penobscot County, ME', 'Westchester County, NY', 'Rock Island County, IL', 'Navajo County, AZ', 'Cecil County, MD', 'New Hanover County, NC', 'Washington County, OR', 'Morris County, NJ', 'Cass County, ND', 'Orange County, NC', 'Kendall County, IL', 'Kaufman County, TX', 'La Porte County, IN', 'Clayton County, GA', 'DeKalb County, IL', 'Nassau County, NY', 'Mercer County, NJ', 'Oakland County, MI', 'Washington County, MD', 'Washington County, UT', 'Yellowstone County, MT', 'Seminole County, FL', 'Clermont County, OH', 'Santa Clara County, CA', 'Forsyth County, NC', 'Broome County, NY', 'Thurston County, WA', 'Blair County, PA', 'Snohomish County, WA', 'Skagit County, WA', 'Maui County, HI', 'Chester County, PA']

urban_counties_index = []
rural_counties_index = []
unlabelled_counties_index = []
urban_counties = []
rural_counties = []
unlabelled_counties = []

for i, county in enumerate(original_counties):
    if county in counties_dict:
        if counties_dict[county] == "URBAN":
            urban_counties_index.append(i)
            urban_counties.append(county)
        elif counties_dict[county] == "RURAL":
            rural_counties_index.append(i)
            rural_counties.append(county)
        else:
            unlabelled_counties_index.append(i)
            unlabelled_counties.append(county)
    else:
        unlabelled_counties.append(county)
        unlabelled_counties_index.append(i)

print("Urban Counties Index:", urban_counties_index)
print("Rural Counties Index:", rural_counties_index)
print("Unlabelled Counties Index:", unlabelled_counties_index)
print("Urban Counties:", urban_counties)
print("Rural Counties:", rural_counties)
print("Unlabelled Counties:", unlabelled_counties)
